# Reproducible Research: Peer Assessment 1



## Loading and preprocessing the data

setting the directory:
```{r}
    currentDirectory <- getwd()
    newDirectory <- paste(currentDirectory,"/PeerAssessment1",sep="")
    if(!file.exists("PeerAssessment1")){dir.create("PeerAssessment1")}
    setwd(newDirectory)
```

downloading, unzipping and reading the data:
```{r}
    setInternet2()
    file <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
    download.file(file,"data.zip")    
    unzip("data.zip")
    data <- read.csv("activity.csv")
```

loading required packages:
```{r}
    install.packages("lattice",repos="http://cran.us.r-project.org")
    library("lattice")
```

## What is mean total number of steps taken per day?

computing distribution of total number of steps per day:

```{r}
    datazero <- data
    data<-data[complete.cases(data),]
    StepsPerDayTotal <- tapply(data$steps,data$date,sum,na.rm=T)
```

plotting the histogram:
```{r}
    hist(StepsPerDayTotal,xlab="Number of Steps",
    main="Distribution Total Number of Steps per Day")
```

computing and reporting mean **number** of **steps per day**:
```{r}
    StepsPerDayMean <- tapply(data$steps,data$date,mean,na.rm=T)
    StepsPerDayMean 
```


computing and reporting median **number** of **steps per day**:
```{r}
    StepsPerDayMedian <- tapply(data$steps,data$date,median,na.rm=T)
    StepsPerDayMedian
```

calculating **mean** number of **total steps over all days**:
```{r}
    MEAN <- mean(StepsPerDayTotal,na.rm=T)
    MEAN
```

calculating **median** number of **total steps over all days**:
```{r}
    MEDIAN <- median(StepsPerDayTotal,na.rm=T)
    MEDIAN
```

The **mean** and **median** number of total steps over all days are **`r MEAN`** and **`r MEDIAN`**.



## What is the average daily activity pattern?

calculating average number of steps taken per time interval, averaged across all days:
```{r}
    data <- datazero 
    IntervalAverages <- tapply(data$steps,data$interval,mean,na.rm=T)
```

plotting time series data for the average number of steps taken per time interval:
```{r}
    plot(x=names(IntervalAverages),y=IntervalAverages,type="l", xlab="time inteval", 
    ylab="number of steps", main="Number of Steps Averaged per Time Interval")
```

computing the maximum:
```{r}
    Maximum <- max(IntervalAverages)
    MaxPos <- IntervalAverages == Maximum
    (IntervalAverages[MaxPos])
    MaxInterval <- names(IntervalAverages[MaxPos])
```

The Interval **`r MaxInterval`** has on average the highest number of steps: **`r Maximum`**


## Imputing missing values

Creating data frame *dataNaRm* in which missing values are replaced with the related interval's average.

finding positions, intervals and the number of points for which no values were recorded:
```{r}
    MissingValues <- is.na(data$steps)
    NumberMissingValues <- sum(MissingValues)
    IntervalMissingValues <- data[MissingValues,"interval"]
    NumberMissingValues
```
For **`r NumberMissingValues`** of the intervals in the dataset no values were recorded.


picking the mean interval values for those points from the *IntervalAverages* calculated above:
```{r}
    MeanValues <- sapply(IntervalMissingValues,function(MVInt)
      {MVIntMean <- MVInt==names(IntervalAverages);IntervalAverages[MVIntMean]})
```

creating new data frame *dataNaRm* where those missing values are replaced by the related interval means:
```{r}
    dataNaRm <- data
    dataNaRm[MissingValues,"steps"] <- MeanValues
```

### Ploting the histogram with the *new* data

```{r}
    hist(tapply(dataNaRm$steps,data$date,sum,na.rm=T),xlab="Number of Steps",
    main="Distribution Total Number of Steps per Day with Missing Values replaced")
```

computing and reporting the **new** mean number of **steps per day**:
```{r}
    StepsPerDayMean <- tapply(dataNaRm$steps,data$date,mean,na.rm=T)
    StepsPerDayMean 
```

computing and reporting the **new** median number of **steps per day**:
```{r}
    StepsPerDayMedian <- tapply(dataNaRm$steps,data$date,median,na.rm=T)
    StepsPerDayMedian
```

calculating the **new** mean number of **total steps over all days**:
```{r}
    MEAN <- mean(tapply(dataNaRm$steps,data$date,sum,na.rm=T))
    MEAN
```

calculating the **new** median number of **total steps over all days**:
```{r}
    MEDIAN <- median(tapply(dataNaRm$steps,data$date,sum,na.rm=T))
    MEDIAN
```

Replacing missing values with mean interval values centralizes the distribution. This results in narrower distribution (see histogram) and a mean closer/equal to the median


## Are there differences in activity patterns between weekdays and weekends?


* transforming date data to date variable:
```{r}
    data <- transform(data,date=as.Date(strptime(date,"%Y-%m-%d")))
```

* adding weekday column:
```{r}
    data$wkday <- weekdays(data$date)
```

* *optional replacing german with english weekday names:*
```{r}
    data$wkday[data$wkday=="Montag"] <- "Monday"
    data$wkday[data$wkday=="Dienstag"] <- "Tuesday"
    data$wkday[data$wkday=="Mittwoch"] <- "Wednesday"
    data$wkday[data$wkday=="Donnerstag"] <- "Thursday"
    data$wkday[data$wkday=="Freitag"] <- "Friday"
    data$wkday[data$wkday=="Samstag"]<-"Saturday"
    data$wkday[data$wkday=="Sonntag"]<-"Sunday"
```

* adding weekday/weekend column:
```{r}
    data$wkend <- rep("weekday",nrow(data))
    wkend <- data$wkday=="Saturday"|data$wkday=="Sunday"
    data$wkend[wkend] <- "weekend"
```

* splitting data into weekday and weekend data frames:
```{r}
    WeekSepList <- split(data,data$wkend)
```

* computing-interval means for weekday and weekend data seperately:
```{r}
    weekday <- tapply(WeekSepList$weekday$steps,WeekSepList$weekday$interval,mean,na.rm=T)
    weekend <- tapply(WeekSepList$weekend$steps,WeekSepList$weekend$interval,mean,na.rm=T)
```

* joining to one data frame:
```{r}
    weekday <- data.frame(steps=as.numeric(weekday),interval=as.numeric(names(weekday)),wkend="weekday")
    weekend <- data.frame(steps=as.numeric(weekend),interval=as.numeric(names(weekend)),wkend="weekend")
    WeekDayComparison <- rbind(weekday,weekend)
```

* plotting the graph:
```{r}
    xyplot(WeekDayComparison$steps~WeekDayComparison$interval|WeekDayComparison$wkend,
    layout=c(1,2),xlab="Interval",ylab="Number of steps",panel=function(x,y,..){
    panel.xyplot(x,y,type="l")}) 
```

#########



* transforming date data to date variable:
```{r}
    dataNaRm <- transform(dataNaRm,date=as.Date(strptime(date,"%Y-%m-%d")))
```

* adding weekday column:
```{r}
    dataNaRm$wkday <- weekdays(dataNaRm$date)
```

* *optional replacing german with english weekday names:*
```{r}
    dataNaRm$wkday[dataNaRm$wkday=="Montag"] <- "Monday"
    dataNaRm$wkday[dataNaRm$wkday=="Dienstag"] <- "Tuesday"
    dataNaRm$wkday[dataNaRm$wkday=="Mittwoch"] <- "Wednesday"
    dataNaRm$wkday[dataNaRm$wkday=="Donnerstag"] <- "Thursday"
    dataNaRm$wkday[dataNaRm$wkday=="Freitag"] <- "Friday"
    dataNaRm$wkday[dataNaRm$wkday=="Samstag"]<-"Saturday"
    dataNaRm$wkday[dataNaRm$wkday=="Sonntag"]<-"Sunday"
```

* adding weekday/weekend column:
```{r}
    dataNaRm$wkend <- rep("weekday",nrow(dataNaRm))
    wkend <- dataNaRm$wkday=="Saturday"|dataNaRm$wkday=="Sunday"
    dataNaRm$wkend[wkend] <- "weekend"
```

* computing-interval means for weekday and weekend data:
```{r}
    WeekDayComparison <- aggregate(dataNaRm$steps ~ dataNaRm$interval + dataNaRm$wkend, list(dataNaRm$interval), FUN=mean)
    colnames(WeekDayComparison) <- c("interval", "wkend", "steps")
```

* plotting the graph:
```{r}
    xyplot(WeekDayComparison$steps~WeekDayComparison$interval|WeekDayComparison$wkend,
    layout=c(1,2),xlab="Interval",ylab="Number of steps",panel=function(x,y,..){
    panel.xyplot(x,y,type="l")}) 
```

